<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Encryption Helper Â· Event Stable v1.3.1</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
:root{
  --bg:#050000;
  --panel:#120202;
  --border:rgba(255,80,40,.35);
  --accent:#ff5a2a;
  --text:#fff2ec;
  --muted:#cfa99a;
  --warn:#ffb000;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:JetBrains Mono,monospace;
  background:var(--bg);
  color:var(--text)
}
.app{max-width:960px;margin:auto;padding:22px 14px 36px}
h1{
  text-align:center;
  margin:0;
  color:var(--accent);
  text-shadow:0 0 18px rgba(255,90,42,.35)
}
.sub{text-align:center;color:var(--muted)}
.tabs,.bar{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
  margin:12px 0
}
.tab,.btn,.pill{
  padding:9px 16px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#000;
  color:var(--accent);
  cursor:pointer;
  font-weight:700
}
.tab.active{background:rgba(255,90,42,.15)}
.btn:hover,.tab:hover,.pill:hover{
  box-shadow:0 0 12px rgba(255,90,42,.35)
}
.panel{
  display:none;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px
}
.panel.active{display:block}
label{
  font-size:.75rem;
  color:var(--muted);
  margin-top:10px;
  display:block
}
textarea,input,select{
  width:100%;
  margin-top:6px;
  padding:10px;
  border-radius:12px;
  background:#000;
  border:1px solid var(--border);
  color:var(--accent)
}
textarea{min-height:90px}
textarea:focus,input:focus,select:focus{
  outline:none;
  box-shadow:0 0 10px rgba(255,90,42,.4)
}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.small{font-size:.7rem;color:var(--muted)}
.warn{color:var(--warn)}
.footer{
  text-align:center;
  color:var(--muted);
  font-size:.75rem;
  margin-top:20px;
  border:none
}
.footer a{
  color:var(--accent);
  text-decoration:none;
  font-weight:700
}
</style>
</head>

<body>
<div class="app">

<h1>ENCRYPTION HELPER</h1>
<div class="sub">Event Cryptography Toolkit Â· v1.3.1</div>

<div class="bar">
  <button class="pill" id="ivDet" onclick="toggleDetIV()">Deterministic IV: OFF</button>
</div>

<div class="small" style="text-align:center">
Client-side only Â· No data leaves your browser
</div>

<div class="tabs">
  <button class="tab active" onclick="showTab(event,'enc')">Encrypt / Decrypt</button>
  <button class="tab" onclick="showTab(event,'guess')">Context Key Tester</button>
  <button class="tab" onclick="showTab(event,'b64')">Base64 / HEX</button>
  <button class="tab" onclick="showTab(event,'an')">Analyze</button>
</div>

<!-- Encrypt / Decrypt -->
<div id="enc" class="panel active">
<label>Action</label>
<select id="encAction">
  <option value="decrypt">decrypt</option>
  <option value="encrypt">encrypt</option>
</select>

<label>Input</label>
<textarea id="encInput"></textarea>

<div class="row">
  <select id="encAlgo" onchange="onAlgoChange()"></select>
  <select id="encMode"></select>
</div>

<div class="small warn" id="algoWarn"></div>

<label>Key</label>
<input id="encKey">

<label>Output</label>
<textarea id="encOutput" readonly></textarea>
<div class="small" id="confidence"></div>
<button class="btn" onclick="copyText('encOutput')">ðŸ“‹ Copy</button>
</div>

<!-- Key Guesser -->
<div id="guess" class="panel">
<label>Ciphertext</label>
<textarea id="guessCipher"></textarea>

<label>Event Text / Article</label>
<textarea id="keySource" placeholder="Paste announcement, rules, blog, etc."></textarea>

<div class="small warn">
Context-based guessing Â· max 50 keys Â· AES-CBC
</div>

<button class="btn" onclick="tryContextKeys()">âš¡ Extract & Try Keys</button>
<textarea id="guessOutput" readonly></textarea>
</div>

<!-- Base64 -->
<div id="b64" class="panel">
<label>Input</label>
<textarea id="b64Input"></textarea>
<button class="btn" onclick="unwrapBase64()">Base64 â†’ RAW (HEX)</button>
<textarea id="b64Output" readonly></textarea>
</div>

<!-- Analyze -->
<div id="an" class="panel">
<label>Input</label>
<textarea id="anInput"></textarea>
<textarea id="anOutput" readonly></textarea>
</div>

<div class="footer">
Built by <a href="https://x.com/L3SSSOUL" target="_blank">@L3SSSOUL</a>
</div>

</div>

<script>
const ALGO_INFO={AES:{block:16},DES:{block:8},TripleDES:{block:8}};
let DET_IV=false;

function toggleDetIV(){
  DET_IV=!DET_IV;
  ivDet.textContent='Deterministic IV: '+(DET_IV?'ON':'OFF');
}
function showTab(e,id){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  e.target.classList.add('active');
}
function populate(){
  Object.keys(ALGO_INFO).forEach(a=>encAlgo.add(new Option(a,a)));
  ['CBC','CFB','ECB','OFB'].forEach(m=>encMode.add(new Option(m,m)));
  encAlgo.value='AES';
}
populate();

function onAlgoChange(){
  algoWarn.textContent=encAlgo.value==='AES'?'':'âš ï¸ Advanced / non-event algorithm';
}
function normalizeBase64(s){
  return s.replace(/\s+/g,'').replace(/-/g,'+').replace(/_/g,'/');
}
function keyToWA(key,algo){
  const size=ALGO_INFO[algo].block;
  return CryptoJS.enc.Utf8.parse(key.padEnd(size,'0').slice(0,size));
}
function englishScore(t){
  return Math.round(((t.match(/[a-zA-Z ]/g)||[]).length/Math.max(1,t.length))*100);
}
function parseCipherPart(s){
  const c=normalizeBase64(s);
  return /^[0-9a-fA-F]+$/.test(c)
    ? CryptoJS.enc.Hex.parse(c)
    : CryptoJS.enc.Base64.parse(c);
}
function autoParseInput(input,algo){
  const block=ALGO_INFO[algo].block*2;
  if(input.includes(':')){
    const [ivHex,c]=input.split(':');
    return {iv:CryptoJS.enc.Hex.parse(ivHex),data:parseCipherPart(c)};
  }
  if(/^[A-Za-z0-9+/=_-]+$/.test(input)){
    const wa=CryptoJS.enc.Base64.parse(normalizeBase64(input));
    const hex=CryptoJS.enc.Hex.stringify(wa);
    if(hex.length>block){
      return {iv:CryptoJS.enc.Hex.parse(hex.slice(0,block)),data:CryptoJS.enc.Hex.parse(hex.slice(block))};
    }
  }
  if(/^[0-9a-fA-F]+$/.test(input)){
    return {iv:CryptoJS.enc.Hex.parse(input.slice(0,block)),data:CryptoJS.enc.Hex.parse(input.slice(block))};
  }
  return null;
}

function realtime(){
  encOutput.value='';
  confidence.textContent='';
  const t=encInput.value.trim();
  const k=encKey.value;
  const algo=encAlgo.value;
  const mode=CryptoJS.mode[encMode.value];
  if(!t||!k)return;
  try{
    const keyWA=keyToWA(k,algo);
    if(encAction.value==='encrypt'){
      const iv=DET_IV
        ? CryptoJS.enc.Hex.parse(keyWA.toString().slice(0,ALGO_INFO[algo].block*2))
        : CryptoJS.lib.WordArray.random(ALGO_INFO[algo].block);
      const out=CryptoJS[algo].encrypt(t,keyWA,{iv,mode,padding:CryptoJS.pad.Pkcs7});
      encOutput.value=iv.toString(CryptoJS.enc.Hex)+':'+out.toString();
      return;
    }
    const parsed=autoParseInput(t,algo);
    if(!parsed){encOutput.value='[!] Unsupported input format';return;}
    const out=CryptoJS[algo].decrypt(
      {ciphertext:parsed.data},
      keyWA,
      {iv:parsed.iv,mode,padding:CryptoJS.pad.Pkcs7}
    ).toString(CryptoJS.enc.Utf8);
    encOutput.value=out||'[!] Decryption failed';
    const s=englishScore(out);
    confidence.textContent=s>=75?`âœ… English confidence: ${s}%`:`âš ï¸ Low confidence: ${s}%`;
  }catch{encOutput.value='[!] Decryption failed'}
}
['encInput','encKey','encAction','encAlgo','encMode']
.forEach(id=>document.getElementById(id).addEventListener('input',realtime));

function extractKeys(text){
  const STOP=['this','that','with','from','your','have','will','welcome','there','their'];
  return [...new Set(
    text.toLowerCase().replace(/[^a-z0-9\s]/g,'').split(/\s+/)
      .filter(w=>w.length>=4&&w.length<=16&&!/^\d+$/.test(w)&&!STOP.includes(w))
  )].slice(0,50);
}
function tryContextKeys(){
  if(!guessCipher.value.trim()){guessOutput.value='[!] Paste ciphertext';return;}
  if(!keySource.value.trim()){guessOutput.value='[!] Paste event text';return;}
  const parsed=autoParseInput(guessCipher.value,'AES');
  if(!parsed){guessOutput.value='[!] Unsupported ciphertext format';return;}
  let out='';
  extractKeys(keySource.value).forEach(k=>{
    try{
      const d=CryptoJS.AES.decrypt(
        {ciphertext:parsed.data},
        keyToWA(k,'AES'),
        {iv:parsed.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}
      ).toString(CryptoJS.enc.Utf8);
      if(d&&englishScore(d)>=75) out+=`âœ” ${k}\n${d}\n\n`;
    }catch{}
  });
  guessOutput.value=out||'âœ– No keys matched';
}
function unwrapBase64(){
  try{
    b64Output.value=CryptoJS.enc.Hex.stringify(
      CryptoJS.enc.Base64.parse(normalizeBase64(b64Input.value))
    );
  }catch{b64Output.value='[!] Invalid Base64'}
}
function analyzeInput(){
  const t=anInput.value.trim();
  let r=[];
  if(/^[A-Za-z0-9+/=_-]+$/.test(t)) r.push('[+] Base64-like');
  if(/^[0-9a-fA-F]+$/.test(t)) r.push('[+] HEX');
  if(t.includes(':')) r.push('[+] IV:DATA format');
  r.push('[âœ“] Try decrypt directly');
  anOutput.value=r.join('\n');
}
anInput.addEventListener('input',analyzeInput);
function copyText(id){
  navigator.clipboard.writeText(document.getElementById(id).value||'');
}
</script>
</body>
</html>
