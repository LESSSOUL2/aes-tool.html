<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Encryption Decryption Tool Â· Event Stable v1.1</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
:root{
  --bg:#020403;--panel:#03160c;
  --border:rgba(0,255,120,.35);
  --green:#00ff88;--text:#eafff4;--muted:#7fa99a;
  --warn:#ffb000;
}
*{box-sizing:border-box}
body{margin:0;font-family:JetBrains Mono,monospace;background:var(--bg);color:var(--text)}
.app{max-width:960px;margin:auto;padding:22px 14px 36px}
h1{text-align:center;margin:0;color:var(--green)}
.sub{text-align:center;color:var(--muted);margin-bottom:8px}
.tabs,.bar{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin:10px 0}
.tab,.btn,.pill{
  padding:9px 16px;border-radius:999px;
  border:1px solid var(--border);
  background:#000;color:var(--green);
  cursor:pointer;font-weight:700
}
.tab.active{background:rgba(0,255,120,.15)}
.panel{display:none;background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px}
.panel.active{display:block}
label{font-size:.75rem;color:var(--muted);margin-top:10px;display:block}
textarea,input,select{
  width:100%;margin-top:6px;padding:10px;border-radius:12px;
  background:#000;border:1px solid var(--border);color:var(--green)
}
textarea{min-height:90px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.small{font-size:.7rem;color:var(--muted)}
.warn{color:var(--warn)}
.footer{text-align:center;color:var(--muted);font-size:.75rem;margin-top:14px}
.footer a{color:var(--green);text-decoration:none;font-weight:700}
.footer a:hover{text-decoration:underline}
</style>
</head>

<body>
<div class="app">
<h1>ENCRYPTION DECRYPTION HELPER</h1>
<div class="sub">EVENT Â· MULTI-ALGO Â· STABLE</div>

<div class="bar">
  <button class="pill" id="ivDet" onclick="toggleDetIV()">Deterministic IV: OFF</button>
</div>

<div class="tabs">
  <button class="tab active" onclick="showTab(event,'enc')">Encrypt / Decrypt</button>
  <button class="tab" onclick="showTab(event,'guess')">Key Guesser</button>
  <button class="tab" onclick="showTab(event,'b64')">Base64 / HEX</button>
  <button class="tab" onclick="showTab(event,'an')">Analyze</button>
</div>

<!-- Encrypt / Decrypt -->
<div id="enc" class="panel active">
<label>Action</label>
<select id="encAction">
  <option value="decrypt">decrypt</option>
  <option value="encrypt">encrypt</option>
</select>

<label>Input</label>
<textarea id="encInput"></textarea>

<div class="row">
  <select id="encAlgo" onchange="onAlgoChange()"></select>
  <select id="encMode" onchange="handleECB()"></select>
</div>

<div class="small warn" id="algoWarn"></div>

<label>Key</label>
<input id="encKey">

<label><input type="checkbox" id="rawHex"> Cipher is RAW (HEX)</label>

<label>IV (optional)</label>
<input id="encIV">

<label>Output</label>
<textarea id="encOutput" readonly></textarea>
<div class="small" id="confidence"></div>
<button class="btn" onclick="copyText('encOutput')">ðŸ“‹ Copy Output</button>
</div>

<!-- Key Guesser -->
<div id="guess" class="panel">
<label>Ciphertext (IV:DATA)</label>
<textarea id="guessCipher"></textarea>
<button class="btn" onclick="tryCommonKeys()">âš¡ Try Common Event Keys</button>
<label>Result</label>
<textarea id="guessOutput" readonly></textarea>
</div>

<!-- Base64 / HEX -->
<div id="b64" class="panel">
<label>Input</label>
<textarea id="b64Input"></textarea>
<button class="btn" onclick="unwrapBase64()">Base64 â†’ RAW (HEX)</button>
<label>Output</label>
<textarea id="b64Output" readonly></textarea>
</div>

<!-- Analyze -->
<div id="an" class="panel">
<label>Input</label>
<textarea id="anInput"></textarea>
<label>Analysis</label>
<textarea id="anOutput" readonly></textarea>
</div>

<div class="footer">
Built by <a href="https://x.com/L3SSSOUL" target="_blank">@L3SSSOUL</a> Â· Event Stable v1.1
</div>
</div>

<script>
/* ===== Algorithm metadata (CRITICAL) ===== */
const ALGO_INFO = {
  AES: { block:16 },
  DES: { block:8 },
  TripleDES: { block:8 }
};

let DET_IV=false;

function toggleDetIV(){
  DET_IV=!DET_IV;
  ivDet.textContent='Deterministic IV: '+(DET_IV?'ON':'OFF');
}

function showTab(e,id){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  e.target.classList.add('active');
}

/* Populate algorithms & modes */
function populate(){
  Object.keys(ALGO_INFO).forEach(a=>encAlgo.add(new Option(a,a)));
  ['CBC','CFB','ECB','OFB'].forEach(m=>encMode.add(new Option(m,m)));
  encAlgo.value='AES';
}
populate();

function onAlgoChange(){
  const a=encAlgo.value;
  algoWarn.textContent = a==='AES'
    ? ''
    : 'âš ï¸ Advanced / non-event algorithm (AES recommended)';
}

function handleECB(){
  encIV.disabled = encMode.value==='ECB';
  if(encMode.value==='ECB') encIV.value='';
}

function normalizeBase64(s){
  return s.replace(/\s+/g,'').replace(/-/g,'+').replace(/_/g,'/');
}

function englishScore(t){
  return Math.round(((t.match(/[a-zA-Z ]/g)||[]).length/Math.max(1,t.length))*100);
}

function aesDecrypt(dataWA,key,iv,mode,algo){
  return CryptoJS[algo].decrypt(
    {ciphertext:dataWA},
    key,
    {iv,mode,padding:CryptoJS.pad.Pkcs7}
  ).toString(CryptoJS.enc.Utf8);
}

function genIV(key,algo){
  const size = ALGO_INFO[algo].block;
  return DET_IV
    ? CryptoJS.enc.Utf8.parse(key.padEnd(size,'0').slice(0,size))
    : CryptoJS.lib.WordArray.random(size);
}

function realtime(){
  encOutput.value='';
  confidence.textContent='';
  const text=encInput.value.trim();
  const key=encKey.value;
  const algo=encAlgo.value;
  const mode=CryptoJS.mode[encMode.value];
  if(!text||!key) return;

  try{
    if(encAction.value==='encrypt'){
      const iv=genIV(key,algo);
      const out=CryptoJS[algo].encrypt(text,key,{iv,mode});
      encOutput.value=iv.toString(CryptoJS.enc.Hex)+':'+out.toString();
      return;
    }

    const block=ALGO_INFO[algo].block*2;
    let iv,data;

    if(rawHex.checked){
      iv=CryptoJS.enc.Hex.parse(text.slice(0,block));
      data=CryptoJS.enc.Hex.parse(text.slice(block));
    }else{
      const p=text.split(':');
      iv=CryptoJS.enc.Hex.parse(p[0]);
      data=CryptoJS.enc.Base64.parse(normalizeBase64(p[1]));
    }

    const out=aesDecrypt(data,key,iv,mode,algo);
    encOutput.value=out||'[!] Decryption failed';
    const s=englishScore(out);
    confidence.textContent=s>=75
      ? `âœ… English confidence: ${s}%`
      : `âš ï¸ Low confidence: ${s}%`;

  }catch{
    encOutput.value='[!] Decryption failed';
  }
}

['encInput','encKey','encAction','encMode','rawHex','encAlgo']
.forEach(id=>document.getElementById(id).addEventListener('input',realtime));

function tryCommonKeys(){
  if(encAlgo.value!=='AES'){
    guessOutput.value='[!] Common keys optimized for AES only';
    return;
  }
  const keys=['fluton','encrypted','event','flutonevent','testnet'];
  let out='';
  keys.forEach(k=>{
    try{
      const p=guessCipher.value.split(':');
      const iv=CryptoJS.enc.Hex.parse(p[0]);
      const data=CryptoJS.enc.Base64.parse(normalizeBase64(p[1]));
      const d=aesDecrypt(data,k,iv,CryptoJS.mode.CBC,'AES');
      if(d && englishScore(d)>=75){
        out+=`âœ” ${k}\n${d}\n\n`;
      }
    }catch{}
  });
  guessOutput.value=out||'âœ– No common keys matched';
}

function unwrapBase64(){
  try{
    const wa=CryptoJS.enc.Base64.parse(normalizeBase64(b64Input.value));
    b64Output.value=CryptoJS.enc.Hex.stringify(wa);
  }catch{
    b64Output.value='[!] Invalid Base64';
  }
}

function analyzeInput(){
  const t=anInput.value.trim();
  let r=[];
  if(/^[A-Za-z0-9+/=_-]+$/.test(t)) r.push('[+] Base64-like detected');
  if(/^[0-9a-fA-F]+$/.test(t)) r.push('[+] HEX (raw bytes)');
  if(t.includes(':')) r.push('[+] IV-prefixed format');
  r.push('[âœ“] Suggested: unwrap â†’ decrypt');
  anOutput.value=r.join('\n');
}
anInput.addEventListener('input',analyzeInput);

function copyText(id){
  navigator.clipboard.writeText(document.getElementById(id).value||'');
}
</script>
</body>
</html>
