<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Encryption Decryption Tool v2.7.5</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
:root{
  --bg:#020403;
  --panel:#03160c;
  --border:rgba(0,255,120,.35);
  --green:#00ff88;
  --text:#eafff4;
  --muted:#7fa99a
}
*{box-sizing:border-box}
body{margin:0;font-family:'JetBrains Mono',monospace;background:var(--bg);color:var(--text)}
.app{max-width:960px;margin:auto;padding:24px 14px 40px}
h1{text-align:center;margin:0;font-size:2rem;color:var(--green)}
.sub{text-align:center;color:var(--muted);margin-bottom:4px}
.mode-indicator{text-align:center;font-size:.75rem;color:#9fffd2;margin-bottom:10px}

.bar,.tabs{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin:12px 0}
.pill,.tab,.btn{
  padding:10px 16px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#000;
  color:var(--green);
  cursor:pointer;
  font-weight:700
}
.active{background:rgba(0,255,120,.18)}

.panel{
  display:none;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:16px;
  padding:18px
}
.panel.active{display:block}

label{margin-top:10px;font-size:.75rem;color:var(--muted);display:block}
textarea,input,select{
  width:100%;
  margin-top:6px;
  padding:12px;
  border-radius:12px;
  background:#000;
  border:1px solid var(--border);
  color:var(--green)
}
textarea{min-height:90px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}

.footer{text-align:center;color:var(--muted);font-size:.75rem;margin-top:16px}

/* controlled visibility */
.full{display:none}
.lab{display:none}
</style>
</head>

<body>
<div class="app">
<h1>ENCRYPTION DECRYPTION HELPER</h1>
<div class="sub">ENCRYPT · DECRYPT · ANALYSE · TEST LAB</div>
<div id="modeLabel" class="mode-indicator">Mode: Guided Event</div>

<div class="bar">
  <button class="pill active" id="modeGuided">Guided Event Mode</button>
  <button class="pill" id="modeFull">Full Toolkit Mode</button>
  <button class="pill" id="ivDet">Deterministic IV: OFF</button>
  <button class="pill" id="labToggle">Test Lab: OFF</button>
</div>

<div class="tabs" id="tabs">
  <button class="tab active" data-tab="enc">Encrypt / Decrypt</button>
  <button class="tab" data-tab="an">Analyze</button>
  <button class="tab full" data-tab="b64">Base64 / HEX</button>
  <button class="tab full" data-tab="guess">Key Guesser</button>
  <button class="tab full" data-tab="decoy">Decoy Analysis</button>
  <button class="tab lab" data-tab="lab">Test Lab</button>
</div>

<!-- PANELS -->
<div id="enc" class="panel active">
  <label>Action</label>
  <select id="encAction"><option>encrypt</option><option>decrypt</option></select>
  <label>Input</label><textarea id="encInput"></textarea>
  <div class="row"><select id="encAlgo"></select><select id="encMode"></select></div>
  <label>Key</label><input id="encKey">
  <label>IV</label><input id="encIV" placeholder="optional">
  <label>Output</label><textarea id="encOutput" readonly></textarea>
</div>

<div id="an" class="panel">
  <label>Input</label><textarea id="anInput"></textarea>
  <label>Analysis</label><textarea id="anOutput" readonly></textarea>
</div>

<div id="b64" class="panel full">
  <label>Input</label><textarea id="b64Input"></textarea>
  <div class="row">
    <button class="btn" onclick="encodeBase64()">Text → Base64</button>
    <button class="btn" onclick="decodeBase64()">Base64 → Text</button>
  </div>
  <div class="row">
    <button class="btn" onclick="encodeHex()">Text → HEX</button>
    <button class="btn" onclick="decodeHex()">HEX → Text</button>
  </div>
  <label>Output</label><textarea id="b64Output" readonly></textarea>
</div>

<div id="guess" class="panel full">
  <label>Encrypted Text</label><textarea id="guessCipher"></textarea>
  <label>Context Text</label><textarea id="guessContext"></textarea>
  <div class="row3">
    <select id="ivStrategy"><option>auto</option><option>zero</option><option>key</option></select>
    <select id="guessMode"></select>
    <select id="guessAlgo"></select>
  </div>
  <button class="btn" onclick="runGuess()">Try Keys</button>
  <textarea id="guessOutput" readonly></textarea>
</div>

<div id="decoy" class="panel full">
  <label>Context / Hints</label><textarea id="decoyContext"></textarea>
  <button class="btn" onclick="runDecoyAnalysis(true)">Analyze & Send</button>
  <textarea id="decoyOutput" readonly></textarea>
</div>

<div id="lab" class="panel full lab">
  <label>Wordlist</label><textarea id="labWords"></textarea>
  <div class="row3">
    <input id="labMax" value="500">
    <input id="labRate" value="10">
    <select id="labIV"><option>zero</option><option>key</option></select>
  </div>
  <button class="btn" onclick="runLab()">Run Test</button>
  <textarea id="labOut" readonly></textarea>
</div>

<div class="footer">
Built by <a href="https://x.com/L3SSSOUL" target="_blank" style="color:#00ff88;text-decoration:none">@L3SSSOUL</a> · v2.7.5
</div>
</div>

<script>
let MODE='guided',DET_IV=false,LAB=false;

/* MODE CONTROL — FIXED */
modeGuided.onclick=()=>setMode('guided');
modeFull.onclick=()=>setMode('full');

function setMode(m){
  MODE=m;
  modeGuided.classList.remove('active');
  modeFull.classList.remove('active');
  (m==='guided'?modeGuided:modeFull).classList.add('active');

  document.querySelectorAll('.full').forEach(e=>e.style.display=m==='full'?'':'none');
  document.getElementById('modeLabel').textContent =
    m==='guided'?'Mode: Guided Event':'Mode: Full Toolkit (Advanced)';

  populate();

  // auto-focus so user SEES change
  activateTab(m==='full'?'an':'enc');
}

function activateTab(id){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelector(`.tab[data-tab="${id}"]`)?.classList.add('active');
}

/* tab clicks */
document.querySelectorAll('.tab').forEach(t=>{
  t.onclick=()=>activateTab(t.dataset.tab);
});

/* populate algos */
function populate(){
  encAlgo.innerHTML='';encMode.innerHTML='';
  guessAlgo.innerHTML='';guessMode.innerHTML='';
  const algos=MODE==='guided'?['AES']:['AES','DES','TripleDES'];
  const modes=MODE==='guided'?['CBC']:['CBC','CFB','ECB','OFB'];
  algos.forEach(a=>{encAlgo.add(new Option(a,a));guessAlgo.add(new Option(a,a))});
  modes.forEach(m=>{encMode.add(new Option(m,m));guessMode.add(new Option(m,m))});
}

/* Base64 / HEX */
function encodeBase64(){b64Output.value=CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse(b64Input.value))}
function decodeBase64(){b64Output.value=CryptoJS.enc.Utf8.stringify(CryptoJS.enc.Base64.parse(b64Input.value))}
function encodeHex(){b64Output.value=CryptoJS.enc.Hex.stringify(CryptoJS.enc.Utf8.parse(b64Input.value))}
function decodeHex(){b64Output.value=CryptoJS.enc.Utf8.stringify(CryptoJS.enc.Hex.parse(b64Input.value))}

/* Analyze */
function isLikelyBase64(s){s=s.replace(/\s+/g,'');return s.length%4===0&&/^[A-Za-z0-9+/]+={0,2}$/.test(s)}
anInput.oninput=()=>{anOutput.value=(isLikelyBase64(anInput.value)?'[+] Base64-like detected\n':'')+(anInput.value.length>20?'[+] High entropy':'')}

/* INIT */
populate();
</script>
</body>
</html>
